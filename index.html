<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kamisato Ayaka Shimeji</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        canvas {
            display: block;
            margin: 0 auto;
            background: white;
            border: 1px solid #ccc;
        }

        .debug-message {
            margin-top: 20px;
        }

        .success {
            color: green;
            font-weight: bold;
        }

        .error {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Kamisato Ayaka Shimeji</h1>
    <canvas id="shimejiCanvas" width="800" height="600"></canvas>
    <div id="debug" class="debug-message"></div>

    <script>
        const canvas = document.getElementById("shimejiCanvas");
        const ctx = canvas.getContext("2d");
        const debugElement = document.getElementById("debug");

        const assets = ["walk1.png", "walk2.png", "stand1.png"]; // Add your asset names here.
        const loadedImages = {};
        let currentImageIndex = 0;

        const shimejiState = {
            x: 400, // Starting X position
            y: 300, // Starting Y position
            speed: 2, // Movement speed
            direction: 1, // 1 for right, -1 for left
        };

        function loadAssets(assets) {
            let loadedCount = 0;

            return new Promise((resolve, reject) => {
                assets.forEach(asset => {
                    const img = new Image();
                    img.src = asset;
                    img.onload = () => {
                        loadedImages[asset] = img;
                        debugElement.innerHTML += `<div class="success">✔️ Loaded ${asset}</div>`;
                        loadedCount++;
                        if (loadedCount === assets.length) resolve();
                    };
                    img.onerror = () => {
                        debugElement.innerHTML += `<div class="error">❌ Failed to load ${asset}</div>`;
                        reject(`Failed to load ${asset}`);
                    };
                });
            });
        }

        function renderShimeji() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update Shimeji's position
            shimejiState.x += shimejiState.speed * shimejiState.direction;

            // Reverse direction when hitting canvas edges
            if (shimejiState.x <= 0 || shimejiState.x >= canvas.width - 50) {
                shimejiState.direction *= -1; // Reverse direction
            }

            const currentAsset = assets[currentImageIndex];
            const img = loadedImages[currentAsset];

            if (img) {
                ctx.drawImage(img, shimejiState.x, shimejiState.y);
            }

            // Cycle through assets for animation
            currentImageIndex = (currentImageIndex + 1) % assets.length;

            requestAnimationFrame(renderShimeji); // Smooth animation
        }

        (async function init() {
            debugElement.textContent = "Loading assets...";
            try {
                await loadAssets(assets);
                debugElement.innerHTML += "<div class='success'>✅ All assets loaded successfully!</div>";
                renderShimeji();
            } catch (error) {
                debugElement.innerHTML += `<div class="error">❌ Error: ${error}</div>`;
            }
        })();
    </script>
</body>
</html>